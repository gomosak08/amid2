<!-- app/views/appointments/edit.html.erb -->
<div class="max-w-2xl lg:max-w-3xl mx-auto px-4 md:px-6 py-6">
  <h1 class="text-2xl md:text-3xl font-bold text-center mb-2">Cancelar cita</h1>
  <p class="text-center text-gray-600 text-sm md:text-base mb-6">Revisa la información antes de continuar.</p>

  <% status_key   = (@appointment.status.presence || "scheduled").to_s %>
  <% status_label = @appointment.status_label %>

  <% status_class =
      case status_key
      when "scheduled" then "bg-green-100 text-green-800 ring-1 ring-inset ring-green-200"
      when "canceled_by_admin", "canceled_by_client" then "bg-red-100 text-red-800 ring-1 ring-inset ring-red-200"
      else "bg-gray-100 text-gray-800 ring-1 ring-inset ring-gray-200"
      end %>




  <div class="bg-white rounded-xl shadow p-5 md:p-6 space-y-6">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2">
      <div>
        <span class="block text-xs md:text-sm text-gray-500">Estado</span>
        <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs md:text-sm font-medium <%= status_class %>">
          <%= status_label %>
        </span>
      </div>
    </div>

    <dl class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div class="p-4 rounded-lg bg-gray-50">
        <dt class="text-sm text-gray-600">Paciente</dt>
        <dd class="mt-0.5 text-base font-semibold text-gray-900"><%= @appointment.name %></dd>
      </div>

      <div class="p-4 rounded-lg bg-gray-50">
        <dt class="text-sm text-gray-600">Edad</dt>
        <dd class="mt-0.5 text-base font-semibold text-gray-900"><%= @appointment.age %></dd>
      </div>

      <div class="p-4 rounded-lg bg-gray-50">
        <dt class="text-sm text-gray-600">Médico</dt>
        <dd class="mt-0.5 text-base font-semibold text-gray-900"><%= @appointment.doctor&.name %></dd>
      </div>

      <div class="p-4 rounded-lg bg-gray-50">
        <dt class="text-sm text-gray-600">Paquete</dt>
        <dd class="mt-0.5 text-base font-semibold text-gray-900"><%= @appointment.package&.name %></dd>
      </div>

      <div class="p-4 rounded-lg bg-gray-50 md:col-span-2">
        <dt class="text-sm text-gray-600">Fecha y hora</dt>
        <dd class="mt-0.5 text-base font-semibold text-gray-900">
          <%= l(@appointment.start_date, format: :long) %>
          <% if @appointment.end_date.present? %>
            – <%= l(@appointment.end_date, format: :long) %>
          <% end %>
        </dd>
      </div>

      <div class="p-4 rounded-lg bg-gray-50 md:col-span-2">
        <dt class="text-sm text-gray-600">Código único</dt>
        <dd class="mt-0.5 text-base font-mono font-semibold text-gray-900 tracking-wide">
          <%= @appointment.unique_code %>
        </dd>
      </div>
    </dl>

    <div class="rounded-lg border border-amber-300 bg-amber-50 px-4 py-3 text-amber-900 text-sm leading-relaxed">
      Al cancelar, se liberará este horario para otros pacientes. <strong>Esta acción no se puede deshacer.</strong>
    </div>

    <div class="mt-4 flex flex-col-reverse sm:flex-row items-stretch sm:items-center justify-between gap-3">
      <%= link_to "Volver", root_path,
            class: "inline-flex justify-center px-4 py-2.5 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50 text-sm font-medium" %>

      <%= button_to "Cancelar cita",
            appointment_path(@appointment),
            method: :delete,
            form: { data: { turbo_confirm: "¿Seguro que deseas cancelar esta cita?" } },
            class: "inline-flex justify-center px-4 py-2.5 rounded-md bg-red-600 text-white hover:bg-red-700 text-sm font-semibold shadow-sm" %>
    </div>
  </div>
</div>
